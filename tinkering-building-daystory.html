<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create vlogs from your calendar event - Tinkering with AI</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            color-scheme: light;
        }

        html {
            scroll-behavior: smooth;
            overflow-x: hidden;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            background: #ffffff;
            color: #0f172a;
            line-height: 1.7;
            overflow-x: hidden;
            width: 100%;
            padding-top: 70px;
        }

        a {
            color: inherit;
        }

        .top-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 20;
            background: #ffffff;
            border-bottom: 1px solid #e2e8f0;
        }

        .top-nav-inner {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 18px 32px;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 600;
            font-size: 16px;
            color: #111827;
        }

        .brand span {
            display: inline-block;
            width: 14px;
            height: 14px;
            border-radius: 3px;
            background: linear-gradient(135deg, #0ea5e9 0%, #0c9a64 100%);
        }

        .top-links {
            display: flex;
            gap: 24px;
            font-size: 14px;
        }

        .top-link {
            color: #64748b;
            text-decoration: none;
            padding-bottom: 4px;
            border-bottom: 2px solid transparent;
            transition: color 0.2s, border-color 0.2s;
        }

        .top-link:hover {
            color: #111827;
        }

        .top-link.active {
            color: #111827;
            border-color: #0c9a64;
            font-weight: 500;
        }

        .doc-layout {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 260px minmax(0, 1fr);
            gap: 48px;
            padding: 32px 32px 120px;
            align-items: flex-start;
        }

        .sidebar {
            padding-right: 16px;
            border-right: 1px solid #e2e8f0;
        }

        .sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: rgba(148, 163, 184, 0.4);
            border-radius: 999px;
        }

        .sidebar-heading {
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: #94a3b8;
            margin-bottom: 12px;
        }

        .nav-group {
            margin-bottom: 32px;
        }

        .sidebar-link {
            display: block;
            text-decoration: none;
            color: #334155;
            font-size: 14px;
            padding: 8px 0 8px 14px;
            border-left: 2px solid transparent;
            border-radius: 0 10px 10px 0;
            transition: color 0.2s, border-color 0.2s, background 0.2s;
        }

        .sidebar-link:hover {
            color: #0f172a;
        }

        .sidebar-link.active {
            color: #0f172a;
            font-weight: 600;
            border-color: #4d8ff0;
            background: #dbeafe;
        }

        .article {
            max-width: 740px;
        }

        .article h1 {
            font-size: 36px;
            font-weight: 600;
            margin-bottom: 20px;
            line-height: 1.2;
            color: #111827;
        }

        .article > p {
            font-size: 18px;
            color: #334155;
            margin-bottom: 32px;
        }

        section {
            margin-bottom: 56px;
            scroll-margin-top: 100px;
        }

        section:last-of-type {
            margin-bottom: 0;
        }

        section h2 {
            font-size: 26px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #0f172a;
        }

        section h3 {
            font-size: 18px;
            font-weight: 600;
            margin: 28px 0 12px;
            color: #111827;
        }

        p {
            margin-bottom: 18px;
            color: #334155;
        }

        ul, ol {
            margin: 0 0 24px 24px;
            color: #334155;
        }

        li {
            margin-bottom: 12px;
        }

        code {
            font-family: 'SFMono-Regular', Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;
            background: #f1f5f9;
            padding: 2px 6px;
            border-radius: 6px;
            font-size: 13px;
        }

        .tech-stack {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin: 24px 0;
        }

        .tech-card {
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 16px;
            background: #f8fafc;
        }

        .tech-card h4 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #0f172a;
        }

        .tech-card p {
            font-size: 13px;
            color: #64748b;
            margin: 0;
        }

        .try-button {
            display: block;
            width: 100%;
            padding: 12px 16px;
            background: #000000;
            color: #ffffff;
            text-align: center;
            text-decoration: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
            margin-bottom: 24px;
        }

        .try-button:hover {
            background: #1a1a1a;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        @media (max-width: 1024px) {
            .top-nav-inner,
            .doc-layout {
                padding-left: 20px;
                padding-right: 20px;
            }
        }

        @media (min-width: 961px) {
            .sidebar {
                position: fixed;
                top: 112px;
                left: max(32px, calc(50vw - 568px));
                width: 260px;
                max-height: calc(100vh - 112px - 32px);
                overflow-y: auto;
            }
            .sidebar::after {
                content: '';
                position: fixed;
                top: 112px;
                left: calc(max(32px, calc(50vw - 568px)) + 260px + 16px);
                bottom: 0;
                width: 1px;
                background: #e2e8f0;
                z-index: -1;
            }
            .article {
                grid-column: 2;
            }
        }

        @media (max-width: 960px) {
            .doc-layout {
                grid-template-columns: 1fr;
                gap: 0;
            }

            .sidebar {
                border-right: none;
                border-bottom: 1px solid #e2e8f0;
                padding-bottom: 20px;
                margin-bottom: 32px;
            }
        }

        @media (max-width: 768px) {
            .article pre { padding: 12px; overflow-x: auto; max-width: 100%; }
            .article code { font-size: 12px; word-wrap: break-word; }
            .article h1 { font-size: 28px; }
            .article h2 { font-size: 22px; flex-wrap: wrap; }
        }
    </style>
</head>
<body>
    <header class="top-nav">
        <div class="top-nav-inner">
            <a class="top-link active" href="tinkering.html" style="border-bottom: none; font-weight: 500;">&larr; Back</a>
        </div>
    </header>

    <div class="doc-layout">
        <aside class="sidebar">
            <a href="https://daystory.vercel.app/" target="_blank" class="try-button">Try It Now â†’</a>
            
            <div class="nav-group">
                <div class="sidebar-heading">Overview</div>
                <a class="sidebar-link" href="#idea">The idea</a>
                <a class="sidebar-link" href="#architecture">Architecture</a>
                <a class="sidebar-link" href="#tech-stack">Tech stack</a>
            </div>

            <div class="nav-group">
                <div class="sidebar-heading">Build Process</div>
                <a class="sidebar-link" href="#setup">Initial setup</a>
                <a class="sidebar-link" href="#oauth">Google OAuth</a>
                <a class="sidebar-link" href="#calendar">Calendar sync</a>
                <a class="sidebar-link" href="#script">Script generation</a>
                <a class="sidebar-link" href="#video">Video pipeline</a>
            </div>

            <div class="nav-group">
                <div class="sidebar-heading">Lessons Learned</div>
                <a class="sidebar-link" href="#challenges">Challenges</a>
                <a class="sidebar-link" href="#takeaways">Key takeaways</a>
            </div>
        </aside>

        <article class="article">
            <section id="idea">
                <h1>Create vlogs from your calendar event</h1>
                <p>A step-by-step walkthrough of building a web app that transforms Google Calendar events into Pixar-style video vlogs using GPT-4o and Sora.</p>

                <h2>The idea</h2>
                <p>After creating my life story as a Pixar movie, I wanted to make it easier for anyone to do the same with their daily calendar events. DayStory reads your Google Calendar, writes a narrative script with GPT-4o, and generates a cinematic video with Soraâ€”all in one flow.</p>
                
                <p>The goal was simple: pick any day, choose a character style, and get a short video that tells your day like a movie trailer.</p>
            </section>

            <section id="architecture">
                <h2>Architecture overview</h2>
                <p>The app is built as a full-stack Next.js application with the following flow:</p>
                
                <ol>
                    <li><strong>Authentication:</strong> User signs in with Google OAuth, granting read-only calendar access</li>
                    <li><strong>Calendar sync:</strong> Fetch events for a date range and display in an interactive calendar</li>
                    <li><strong>Day selection:</strong> User picks a day and selects one of five Pixar character archetypes</li>
                    <li><strong>Script generation:</strong> GPT-4o writes a 30-50 word narration script based on events</li>
                    <li><strong>Video generation:</strong> Sora creates a 10-15 second Pixar-style video (or uses mock assets during testing)</li>
                    <li><strong>Video gallery:</strong> Store and replay videos in Firebase, with download and share options</li>
                </ol>
            </section>

            <section id="tech-stack">
                <h2>Tech stack</h2>
                
                <div class="tech-stack">
                    <div class="tech-card">
                        <h4>Frontend</h4>
                        <p>Next.js 14 (App Router), React 18, Tailwind CSS, TypeScript</p>
                    </div>
                    <div class="tech-card">
                        <h4>Backend</h4>
                        <p>Next.js API Routes, NextAuth.js for OAuth</p>
                    </div>
                    <div class="tech-card">
                        <h4>Database & Storage</h4>
                        <p>Firebase Firestore, Firebase Storage</p>
                    </div>
                    <div class="tech-card">
                        <h4>AI Services</h4>
                        <p>OpenAI GPT-4o for scripts, Sora for video generation</p>
                    </div>
                    <div class="tech-card">
                        <h4>External APIs</h4>
                        <p>Google Calendar API v3</p>
                    </div>
                    <div class="tech-card">
                        <h4>Deployment</h4>
                        <p>Vercel (hosting + CDN)</p>
                    </div>
                </div>
            </section>

            <section id="setup">
                <h2>Step 1: Initial setup</h2>
                
                <h3>Project scaffold</h3>
                <p>Started with a Next.js 14 project using the App Router and TypeScript:</p>
                
                <ul>
                    <li>Set up folder structure: <code>app/</code>, <code>components/</code>, <code>lib/</code>, <code>types/</code></li>
                    <li>Configured Tailwind CSS for styling</li>
                    <li>Created environment variable template for secrets</li>
                </ul>

                <h3>Environment variables</h3>
                <p>Defined required secrets upfront to avoid setup issues later:</p>
                <ul>
                    <li><code>GOOGLE_CLIENT_ID</code> and <code>GOOGLE_CLIENT_SECRET</code> (OAuth)</li>
                    <li><code>NEXTAUTH_SECRET</code> (session encryption)</li>
                    <li><code>OPENAI_API_KEY</code> (GPT-4o and Sora)</li>
                    <li><code>FIREBASE_PROJECT_ID</code>, <code>FIREBASE_PRIVATE_KEY</code> (database)</li>
                </ul>
            </section>

            <section id="oauth">
                <h2>Step 2: Google OAuth</h2>
                
                <h3>Setting up OAuth credentials</h3>
                <ol>
                    <li>Created a Google Cloud project and enabled the Google Calendar API</li>
                    <li>Set up OAuth 2.0 credentials with redirect URI: <code>http://localhost:3000/api/auth/callback/google</code></li>
                    <li>Requested <code>calendar.readonly</code> scope to read events without modifying them</li>
                </ol>

                <h3>NextAuth.js integration</h3>
                <p>Used NextAuth.js to handle the OAuth flow cleanly:</p>
                <ul>
                    <li>Configured Google provider with client credentials</li>
                    <li>Stored OAuth access tokens securely in session</li>
                    <li>Added middleware to protect dashboard routes</li>
                </ul>

                <p>The result: a seamless sign-in experience with minimal code.</p>
            </section>

            <section id="calendar">
                <h2>Step 3: Calendar sync</h2>
                
                <h3>Google Calendar API integration</h3>
                <p>Built a calendar service module to fetch events:</p>
                <ul>
                    <li>Used the access token from NextAuth to call <code>calendar.events.list</code></li>
                    <li>Fetched events for a 90-day past and 30-day future window</li>
                    <li>Parsed event data (title, start time, end time, location, description)</li>
                </ul>

                <h3>Displaying the calendar</h3>
                <p>Created an interactive calendar UI where users can:</p>
                <ul>
                    <li>See all events grouped by day</li>
                    <li>Click on a specific day to view event details</li>
                    <li>Add optional personal notes to provide context</li>
                </ul>

                <h3>Optimization</h3>
                <p>Implemented incremental sync using Google's sync tokens to avoid re-fetching unchanged data.</p>
            </section>

            <section id="script">
                <h2>Step 4: Script generation with GPT-4o</h2>
                
                <h3>Prompt engineering</h3>
                <p>Crafted a structured prompt template that feeds GPT-4o:</p>
                <ul>
                    <li>User's name and chosen character archetype</li>
                    <li>List of calendar events with times and descriptions</li>
                    <li>Optional user note for personalization</li>
                    <li>Instructions to write a 30-50 word Pixar-style narration</li>
                </ul>

                <h3>Character archetypes</h3>
                <p>Designed five distinct personalities to match Pixar movie styles:</p>
                <ul>
                    <li><strong>Adventurous Explorer</strong> (Up-inspired)</li>
                    <li><strong>Creative Dreamer</strong> (Inside Out-inspired)</li>
                    <li><strong>Curious Scientist</strong> (Wall-E-inspired)</li>
                    <li><strong>Kindhearted Friend</strong> (Toy Story-inspired)</li>
                    <li><strong>Determined Hero</strong> (Turning Red-inspired)</li>
                </ul>

                <h3>API call</h3>
                <p>Made a simple request to OpenAI's Chat Completions endpoint with <code>temperature: 0.8</code> for creative variety.</p>
            </section>

            <section id="video">
                <h2>Step 5: Video generation pipeline</h2>
                
                <h3>Sora video prompt</h3>
                <p>Built a detailed Sora prompt template that includes:</p>
                <ul>
                    <li>Character name and visual style</li>
                    <li>Scene descriptions for each calendar event</li>
                    <li>Pixar-specific visual details (color palette, lighting, camera movements)</li>
                    <li>Narration script and voice type</li>
                    <li>End card with user's name and date</li>
                </ul>

                <h3>Mock video system</h3>
                <p>Since Sora API access wasn't immediately available, created a fallback system:</p>
                <ul>
                    <li>Pre-generated sample videos for each character archetype</li>
                    <li>Automatic detection: if Sora API key is missing, use mock assets</li>
                    <li>Allowed for end-to-end testing without waiting on API access</li>
                </ul>

                <h3>Firebase storage</h3>
                <p>Uploaded videos to Firebase Storage and stored metadata in Firestore:</p>
                <ul>
                    <li>Video URL and thumbnail</li>
                    <li>Generation timestamp and processing time</li>
                    <li>Share token for public links</li>
                </ul>

                <h3>Video gallery</h3>
                <p>Built a gallery page where users can:</p>
                <ul>
                    <li>Browse all generated videos</li>
                    <li>Replay videos inline</li>
                    <li>Download as MP4 or share via unique link</li>
                </ul>
            </section>

            <section id="challenges">
                <h2>Challenges encountered</h2>
                
                <h3>1. OAuth token refresh</h3>
                <p>Google OAuth tokens expire after an hour. Had to implement automatic token refresh using NextAuth's built-in refresh flow to avoid disrupting the user experience.</p>

                <h3>2. Calendar API rate limits</h3>
                <p>Google Calendar API has strict rate limits. Solved this by:</p>
                <ul>
                    <li>Caching calendar data in Firestore for 5 minutes</li>
                    <li>Using incremental sync with sync tokens</li>
                    <li>Batching requests when fetching multiple days</li>
                </ul>

                <h3>3. Prompt engineering for Sora</h3>
                <p>Getting consistent Pixar-style output required extensive iteration. Key learnings:</p>
                <ul>
                    <li>Be extremely specific about visual style, color palette, and lighting</li>
                    <li>Reference exact Pixar movies for style consistency</li>
                    <li>Include camera movements (crane shots, dolly moves) for cinematic feel</li>
                </ul>

                <h3>4. Video generation time</h3>
                <p>Sora can take 2-5 minutes to generate a video. Added:</p>
                <ul>
                    <li>Async job queue for video generation</li>
                    <li>Real-time status updates using Firebase listeners</li>
                    <li>Email notifications when video is ready</li>
                </ul>
            </section>

            <section id="takeaways">
                <h2>Key takeaways</h2>
                
                <h3>What worked well</h3>
                <ul>
                    <li><strong>Next.js API Routes:</strong> Made it easy to build a full-stack app without separate backend</li>
                    <li><strong>NextAuth.js:</strong> Handled OAuth complexity cleanly</li>
                    <li><strong>Mock video fallback:</strong> Allowed testing end-to-end flow without Sora access</li>
                    <li><strong>Firebase:</strong> Simple setup for database and file storage</li>
                    <li><strong>Prompt templates:</strong> Structured prompts with clear sections made outputs more consistent</li>
                </ul>

                <h3>What I'd do differently</h3>
                <ul>
                    <li><strong>Video processing queue:</strong> Should have used a proper job queue (Bull MQ) from the start instead of retrofitting it</li>
                    <li><strong>Error handling:</strong> Add more graceful degradation when APIs fail</li>
                    <li><strong>Testing:</strong> Write integration tests for OAuth and Calendar API earlier</li>
                    <li><strong>Prompt versioning:</strong> Track prompt changes in Git to compare quality across iterations</li>
                </ul>

                <h3>Cost considerations</h3>
                <p>Per video costs breakdown:</p>
                <ul>
                    <li>GPT-4o script generation: ~$0.01</li>
                    <li>Sora video generation: ~$1.00-$2.00 (estimated)</li>
                    <li>Firebase storage (30 days): ~$0.02</li>
                    <li><strong>Total per video: ~$1.05-$2.05</strong></li>
                </ul>
                <p>Freemium model (2 free videos/month, $9.99 for unlimited) makes sense at these costs.</p>

                <h3>Next steps</h3>
                <ul>
                    <li>Add multi-day story compilation (combine week or month into one video)</li>
                    <li>Allow custom character uploads</li>
                    <li>Add background music selection</li>
                    <li>Build mobile app (React Native)</li>
                    <li>Integrate with Outlook and Apple Calendar</li>
                </ul>
            </section>
        </article>
    </div>

    <script>
        const navLinks = Array.from(document.querySelectorAll('.sidebar-link'));
        const sections = navLinks.map(link => document.querySelector(link.getAttribute('href'))).filter(Boolean);

        if (navLinks.length && sections.length) {
            navLinks[0].classList.add('active');

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (!entry.isIntersecting) {
                        return;
                    }
                    const index = sections.indexOf(entry.target);
                    if (index === -1) {
                        return;
                    }
                    navLinks.forEach(link => link.classList.remove('active'));
                    navLinks[index].classList.add('active');
                });
            }, {
                rootMargin: '-50% 0px -50% 0px',
                threshold: 0
            });

            sections.forEach(section => observer.observe(section));
        }
    </script>
</body>
</html>
